# QEntL 中文显示支持指南

本文档提供了在 Windows 环境下解决 QEntL 中文显示问题的完整解决方案。

## 问题概述

QEntL 环境中的某些文件包含中文字符，在默认情况下可能会出现乱码。这是由于以下原因导致的：

1. 源代码文件的编码格式不一致（可能是 ANSI、UTF-8 或其他编码）
2. 控制台默认代码页不支持中文字符
3. 控制台字体可能不支持中文显示

## 解决方案

我们提供了以下几个脚本来解决这些问题：

### 1. 源代码文件编码转换

运行 `convert_to_utf8.bat` 脚本将所有源代码文件转换为 UTF-8 编码（无 BOM）：

```
convert_to_utf8.bat
```

此脚本将：
- 扫描 src/ 和 tests/ 目录中的所有 .c 和 .h 文件
- 将文件转换为 UTF-8 编码（无 BOM）
- 保持文件内容不变，只修改编码方式

### 2. 设置控制台代码页

我们已经修改了 `qentl.bat` 文件，在程序启动时自动设置控制台代码页为 UTF-8 (65001)。

如果您需要手动设置，可以运行：

```
chcp 65001
```

### 3. 控制台字体配置

运行 `check_font.ps1` PowerShell 脚本来检查和设置控制台字体：

```
powershell -ExecutionPolicy Bypass -File check_font.ps1
```

此脚本将：
- 检查当前控制台字体是否支持中文
- 显示当前代码页设置
- 提供将控制台设置为最佳中文支持配置的选项
- 建议适合显示中文的字体

### 4. 使用专用测试脚本

对于量子基因测试，我们提供了一个专用的测试脚本 `run_gene_test.bat`，它包含了所有必要的中文支持设置：

```
run_gene_test.bat
```

此脚本将：
- 设置 UTF-8 编码
- 尝试配置支持中文的控制台字体
- 编译并运行量子基因测试
- 确保中文正确显示

## 手动设置控制台支持中文

如果以上脚本不能完全解决问题，您可以尝试以下手动步骤：

1. **设置控制台属性**：
   - 右键点击控制台窗口标题栏
   - 选择"属性"
   - 切换到"字体"选项卡
   - 选择支持中文的字体，如"NSimSun"、"Microsoft YaHei"等
   - 点击"确定"保存设置

2. **在 Windows 设置中启用 UTF-8 支持**：
   - 打开 Windows 设置
   - 进入"时间和语言" > "语言"
   - 在"相关设置"下点击"管理语言设置"
   - 点击"管理"按钮
   - 在"非 Unicode 程序的语言"下，选择"中文(简体)"
   - 重启计算机

## 测试中文显示

运行以下命令测试中文是否正确显示：

```
echo 测试中文显示：量子纠缠 量子场 量子基因
```

如果您看到的是正确的中文而不是乱码，说明设置成功。

## 常见问题解答

1. **问题**：为什么设置了 UTF-8 仍然显示乱码？
   **解答**：确保同时设置了 UTF-8 代码页和支持中文的字体。两者缺一不可。

2. **问题**：PowerShell 和 CMD 显示不同？
   **解答**：这是正常的，PowerShell 和 CMD 有不同的字体和编码设置。请分别设置。

3. **问题**：源代码在编辑器中显示正常，但编译后运行显示乱码？
   **解答**：这通常是控制台设置问题，不是源代码问题。请确保控制台设置正确。

## 技术支持

如有进一步问题，请联系 QEntL 开发团队。 